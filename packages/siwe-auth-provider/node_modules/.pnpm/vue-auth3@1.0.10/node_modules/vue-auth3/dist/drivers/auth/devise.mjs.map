{"version":3,"sources":["../../../src/drivers/auth/devise.ts"],"sourcesContent":["import { defineAuthDriver } from \"../../type/drivers/AuthDriver\"\n\nexport default defineAuthDriver({\n  tokens: [\n    \"Token-Type\",\n    \"Access-Token\",\n    \"Client\",\n    \"Uid\",\n    \"Expiry\",\n    \"token-type\",\n    \"access-token\",\n    \"client\",\n    \"uid\",\n    \"expiry\",\n  ],\n\n  request(auth, options, token) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const headers = {} as any,\n      tokens = token.split(\"|\")\n\n    auth.options.drivers.auth.tokens?.forEach((tokenName, index) => {\n      if (tokens[index]) {\n        // eslint-disable-next-line functional/immutable-data\n        headers[tokenName] = tokens[index]\n      }\n    })\n\n    // eslint-disable-next-line functional/immutable-data\n    Object.assign(options.headers, headers)\n\n    return options\n  },\n\n  response(auth, { headers }) {\n    // eslint-disable-next-line  @typescript-eslint/no-explicit-any\n    const token: any[] = []\n\n    if (headers[\"access-token\"] || headers[\"Access-Token\"]) {\n      auth.options.drivers.auth.tokens?.forEach((tokenName) => {\n        if (headers[tokenName]) {\n          // eslint-disable-next-line functional/immutable-data\n          token.push(headers[tokenName])\n        }\n      })\n\n      // Check if access-token more recent than last one\n      const tokenNow = auth.token()\n      if (\n        !tokenNow ||\n        parseInt(token[4], 10) >= parseInt(tokenNow.split(\"|\")[4], 10)\n      ) {\n        return token.join(\"|\")\n      }\n    }\n\n    return null\n  },\n})\n"],"mappings":";;;;;;AAEA,IAAO,iBAAQ,iBAAiB;AAAA,EAC9B,QAAQ;AAAA,IACN;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACF;AAAA,EAEA,QAAQ,MAAM,SAAS,OAAO;AAhBhC;AAkBI,UAAM,UAAU,CAAC,GACf,SAAS,MAAM,MAAM,GAAG;AAE1B,eAAK,QAAQ,QAAQ,KAAK,WAA1B,mBAAkC,QAAQ,CAAC,WAAW,UAAU;AAC9D,UAAI,OAAO,KAAK,GAAG;AAEjB,gBAAQ,SAAS,IAAI,OAAO,KAAK;AAAA,MACnC;AAAA,IACF;AAGA,WAAO,OAAO,QAAQ,SAAS,OAAO;AAEtC,WAAO;AAAA,EACT;AAAA,EAEA,SAAS,MAAM,EAAE,QAAQ,GAAG;AAlC9B;AAoCI,UAAM,QAAe,CAAC;AAEtB,QAAI,QAAQ,cAAc,KAAK,QAAQ,cAAc,GAAG;AACtD,iBAAK,QAAQ,QAAQ,KAAK,WAA1B,mBAAkC,QAAQ,CAAC,cAAc;AACvD,YAAI,QAAQ,SAAS,GAAG;AAEtB,gBAAM,KAAK,QAAQ,SAAS,CAAC;AAAA,QAC/B;AAAA,MACF;AAGA,YAAM,WAAW,KAAK,MAAM;AAC5B,UACE,CAAC,YACD,SAAS,MAAM,CAAC,GAAG,EAAE,KAAK,SAAS,SAAS,MAAM,GAAG,EAAE,CAAC,GAAG,EAAE,GAC7D;AACA,eAAO,MAAM,KAAK,GAAG;AAAA,MACvB;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AACF,CAAC;","names":[]}